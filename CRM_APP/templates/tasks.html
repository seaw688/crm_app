{% extends "default.html" %}
{% load widget_tweaks %}

{% block title %}Tasks{% endblock %}

{% block body %}

    <div class="row">
        <div class="col-auto">
            <div class="card">
                <div class="card-body" style="padding: 0.25rem;">
                    <form action="" method="get">
                        <div class="row justify-content-md-left">


                            {% for field in filter.form.visible_fields %}
                                <div class="col-md-auto"
                                     style="display: flex; padding-top: 0.25rem; padding-bottom: 0.25rem; padding-right: 0px;">
                                    <label style="padding-top: 7px;">{{ field.label }}:</label>{% render_field field class="form-control" style="width: auto;" %}
                                </div>
                            {% endfor %}

                            <div class="col-md-auto"
                                 style="display: flex; padding-top: 0.25rem; padding-bottom: 0.25rem;">
                                <button class="btn btn-primary btn-sm" type="submit">Filter</button>
                            </div>

                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>



    <div class="row">

        {% for task in qs_set %}


            <div class="col-xl-2 col-lg-6 col-md-6 col-sm-12 col-12" style="min-width:300px">
                <div class="card">
                    <div class="card-header" style="padding: 0;">


                        {% if task.status == "TO-DO" %}
                            <span class="badge badge-info float-left">{{ task.get_status_display }}</span>
                        {% elif task.status == "IN-PROGRESS" %}
                            <span class="badge badge-primary float-left">{{ task.get_status_display }}</span>

                        {% elif task.status == "DONE" %}
                            <span class="badge badge-success float-left">{{ task.get_status_display }}</span>
                        {% elif task.status == "CLOSED" %}
                            <span class="badge badge-dark float-left">{{ task.get_status_display }}</span>

                        {% endif %}







                        {% if task.priority == "NORMAL" %}
                            <span class="float-left" style="padding-left: 10px;"><span
                                    class="badge-dot badge-primary"></span>{{ task.get_priority_display }}</span>
                        {% elif task.priority == "HIGH" %}
                            <span class="float-left" style="padding-left: 10px;"><span
                                    class="badge-dot badge-warning"></span>{{ task.get_priority_display }}</span>
                        {% elif task.priority == "URGENT" %}
                            <span class="float-left" style="padding-left: 10px;"><span
                                    class="badge-dot badge-danger"></span>{{ task.get_priority_display }}</span>
                        {% elif task.priority == "LOW" %}
                            <span class="float-left" style="padding-left: 10px;"><span
                                    class="badge-dot badge-success"></span>{{ task.get_priority_display }}</span>
                        {% endif %}


                    </div>


                    <div class="card-body"
                         style="padding-top: 0.25rem;border-bottom: 1px solid #e6e6f2;padding-bottom: 0px;">
                        <div class="row" style="">

                            <div class="col">
                                <small class="text-muted"><a href="/projects/view/{{ task.project.slug }}/"><i
                                        class="fas fa-server"></i>
                                    {{ task.project.title }}</a> /<a
                                        href="/tasks/view/{{ task.slug }}/"> <i class="fas fa-list"></i> task: {{ task.id }}
                                </a></small>
                                {% if task.kind == "FEATURE" %}
                                    <span class="float-right"> <small>Feature <i class="fas fa-tag"></i></small> </span>
                                {% elif task.kind == "BUG" %}
                                    <span class="float-right"> <small>Bug <i class="fas fa-bug"></i></small> </span>
                                {% else %}
                                    <span class="float-right"> <small>Task <i class="fas fa-check"></i></small> </span>
                                {% endif %}
                            </div>

                        </div>


                        <div class="row" style="">

                            <div class="col">
                                <a href="/tasks/{{ task.title }}"><h5 class="card-title"><i
                                        class="fas fa-hashtag"></i>{{ task.title }} </h5></a>
                            </div>
                        </div>


                    </div>

                    <hr style="margin: auto;">

                    <div class="pills-regular">
                        <ul class="nav nav-pills mb-1" id="pills-tab" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" style="padding: 10px;font-size: 14px;" id="pills-info-tab"
                                   data-toggle="pill" href="#pills-info-{{ task.id }}" role="tab" aria-controls="home"
                                   aria-selected="false">Info</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" style="padding: 10px;font-size: 14px;" id="pills-time-tab"
                                   data-toggle="pill" href="#pills-time-{{ task.id }}" role="tab" aria-controls="time"
                                   aria-selected="false">Time</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" style="padding: 10px;font-size: 14px;" id="pills-note-tab"
                                   data-toggle="pill" href="#pills-note-{{ task.id }}" role="tab"
                                   aria-controls="contact" aria-selected="true">Note</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" style="padding: 10px;font-size: 14px;" id="pills-manage-tab"
                                   data-toggle="pill" href="#pills-contact-{{ task.id }}" role="tab"
                                   aria-controls="contact" aria-selected="true">Manage</a>
                            </li>
                        </ul>

                        <div class="card-body" style="padding-top: 0.25rem;">

                            <div class="tab-content" id="pills-tabContent" style="padding: 0px;">
                                <div class="tab-pane active show" id="pills-info-{{ task.id }}" role="tabpanel"
                                     aria-labelledby="pills-info-tab">
                                    <div>

                                        <span class="float-left"> <small>Comments <i
                                                class="fas fa-bullhorn"> {{ task.comments_count }}</i></small> </span>

                                        <span class="float-right"> <small>Attachments <i
                                                class="fas fa-file"> {{ task.files_count }}</i></small> </span>
                                        <br>
                                        <span><small>Deadline: {{ task.deadline|date:"d F Y" }} </small></span>
                                        <br>
                                        <span class="account-name"><small> Created: {{ task.created|date:"d F Y" }}</small></span>
                                        <br>
                                        <span><small>Creator: <a href="/users/{{ task.creator.username }}/">{{ task.creator }}</a></small></span>

                                    </div>

                                </div>
                                <div class="tab-pane fade" id="pills-time-{{ task.id }}" role="tabpanel"
                                     aria-labelledby="pills-time-tab">
                                    {% if task.all_time != None %}
                                        <span class=""><small>All spent time: {{ task.all_time }} h.</small></span>
                                    {% endif %}
                                    <span class=""><small>My spent time: {{ task.my_time }} h.</small></span>

                                </div>
                                <div class="tab-pane fade" id="pills-note-{{ task.id }}" role="tabpanel"
                                     aria-labelledby="pills-contact-tab">
                                    <p>{{ task.note }}</p>
                                </div>
                            </div>
                        </div>

                    <div class="card-footer pb-0 pt-0">

                        {% if task.executor != None %}
                        <div class="media">
                        <div class="align-self-center user-avatar-lg mr-3 rounded">
                                     <a  href="/users/{{task.executor.username}}" >
                                    <img src="{{ task.executor.avatar.url }}" alt="{{ task.executer.username }}" class="align-self-center rounded-circle user-avatar-lg">
                                     </a>
                        </div>
                        <div class="media-body">
                            <a  href="/users/{{task.executor.username}}" >
                            <h5 class="mb-0">Assigned on:</h5>
                            <h6 class="account-description mb-0"><a  href="/users/{{task.executor.username}}" >{{task.executor.username}}</a></h6>
                            <h5 class="mb-0">{{ task.executor.first_name }} {{ task.executor.last_name }}</h5>
                            <h6 class="account-name mb-2">{{task.creator.position}}</h6>
                            </a>
                        </div>
                        </div>
                        {% else %}
                            <div class="text-center">
                            <a href="#" class="btn btn-primary btn-sm mb-2 mt-2 assign-btn" value="{{ task.id }}">Assign on me</a>
                            </div>
                        {% endif %}


                    </div>

                    </div>
                </div>

            </div>


        {% endfor %}
    </div>

{% endblock %}


{% block script %}
<script type="text/javascript">

assign_buttom();

function assign_buttom() {
    $(".assign-btn").click(function (eventObject) {
        var btn_id = $(this).attr("value");
        console.log(btn_id);
        $(".assign-btn,[id="+btn_id+"]").html('<span class="dashboard-spinner spinner-xs"></span>');

    })
}
</script>
{% endblock %}






<span class="badge badge-success float-right" style="background-color: #5889ff; margin: 0; white-space: nowrap;">Feature <i
        class="fas fa-tag"></i></span>
<span class="badge badge-success float-right" style="background-color: #5889ff; margin: 0; white-space: nowrap;">Bug <i
        class="fas fa-bug"></i></span>


<i class="fas fa-list"></i>


<span><i style="color: #fa0;" class="fas fa-circle"></i> HIGH </span>

<input class="btn btn-primary" type="submit" value="Submit"/>


<span class="badge badge-success">{{ task.get_status_display }}</span>


<div style="text-align: center;">
    <span class="badge badge-pill badge-warning">{{ task.priority }}</span>
</div>

<span class="badge badge-success float-right"
      style="padding-bottom: 2px; background-color: #5889ff; margin: 0; white-space: nowrap;">Feature <i
        class="fas fa-tag"></i></span>


<div class="card">
    <div class="card-header tab-regular">
        <ul class="nav nav-tabs card-header-tabs" id="myTab" role="tablist">
            <li class="nav-item">
                <a class="nav-link active show" id="card-tab-1" data-toggle="tab" href="#card-1" role="tab"
                   aria-controls="card-1" aria-selected="true">Card Tab 1</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="card-tab-2" data-toggle="tab" href="#card-2" role="tab" aria-controls="card-2"
                   aria-selected="false">Card Tab 2</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="card-tab-3" data-toggle="tab" href="#card-3" role="tab" aria-controls="card-3"
                   aria-selected="false">Card Tab 3</a>
            </li>
        </ul>
    </div>
    <div class="card-body">
        <div class="tab-content" id="myTabContent">
            <div class="tab-pane fade active show" id="card-1" role="tabpanel" aria-labelledby="card-tab-1">
                <p>Etiam odio eraturabitur scelerisque leo at lectus mollis, ac dictum lectus fermentum. Donec vitae
                    tellus sapieestas sit amet risus eu, interdum sodales metus. </p>
                <p>
                    Phasellus vulputate dui quam, a pretium lorem vestibulum nec. Cras risus nisi, sollicitudin eget dui
                    eu, porta tinci consectetur, leo vel tincidunt imperdiet, nibh nisl consectetur titor purus dui
                    vitae nibh. Donec ut rhoncus elit, eget aliquam enim. </p>
            </div>
            <div class="tab-pane fade" id="card-2" role="tabpanel" aria-labelledby="card-tab-2">
                <p>Donec vitae tellus sapieniam odio erat egestas sit amet risus euCurabitur scelerisque leo at lectus
                    mollisac dictum lectus fermentuminterdum sodales metus. </p>
                <p>
                    Cras risus nisi, sollicitudin eget dui eu, porta tincidunt sem. Donec consectetur, leo vel tincidunt
                    imperdiet, nibh nisl consectetur orci, ut porttitor purus dui vitae nibh. Donec ut rhoncus elit,
                    eget aliquam enim. </p>
            </div>
            <div class="tab-pane fade" id="card-3" role="tabpanel" aria-labelledby="card-tab-3">
                <p>Curabitur scelerisque leo at lectus mollis, ac dictum lectus fermentum. Donec vitae tellus sapien.
                    Etiam odio erat, egestas sit amet risus eu, interdum sodales metus. </p>
                <p>
                    Phasellus vulputate dui quam, a pretium lorem vestibulum nec. Cras risus nisi, sollicitudin eget dui
                    eu, porta tincidunt sem. Donec consectetur, leo vel tincidunt imperdiet, nibh nisl consectetur orci,
                    ut porttitor purus dui vitae nibh. Donec ut rhoncus elit, eget aliquam enim. </p>
            </div>
        </div>
    </div>
</div>


  <div class="media">
                                    <img class="align-self-center user-avatar-lg mr-3 rounded" src="{{ task.executor.avatar.url }}" alt="{{ task.executer.username }}">
                                    <div class="media-body">
                                        <h5 class="mb-0">{{ task.executor.first_name }} {{ task.executor.last_name }}</h5>
                                          <h6 class="account-name">{{tasl.creator.position}}</h6>
                                    </div>
                                </div>
                        </div>